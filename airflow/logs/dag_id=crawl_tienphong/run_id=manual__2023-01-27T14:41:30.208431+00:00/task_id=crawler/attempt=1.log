[2023-01-27T14:41:32.614+0000] {taskinstance.py:1083} INFO - Dependencies all met for <TaskInstance: crawl_tienphong.crawler manual__2023-01-27T14:41:30.208431+00:00 [queued]>
[2023-01-27T14:41:32.628+0000] {taskinstance.py:1083} INFO - Dependencies all met for <TaskInstance: crawl_tienphong.crawler manual__2023-01-27T14:41:30.208431+00:00 [queued]>
[2023-01-27T14:41:32.628+0000] {taskinstance.py:1279} INFO - 
--------------------------------------------------------------------------------
[2023-01-27T14:41:32.629+0000] {taskinstance.py:1280} INFO - Starting attempt 1 of 4
[2023-01-27T14:41:32.629+0000] {taskinstance.py:1281} INFO - 
--------------------------------------------------------------------------------
[2023-01-27T14:41:32.654+0000] {taskinstance.py:1300} INFO - Executing <Task(BashOperator): crawler> on 2023-01-27 14:41:30.208431+00:00
[2023-01-27T14:41:32.660+0000] {standard_task_runner.py:55} INFO - Started process 3756 to run task
[2023-01-27T14:41:32.663+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'crawl_tienphong', 'crawler', 'manual__2023-01-27T14:41:30.208431+00:00', '--job-id', '420', '--raw', '--subdir', 'DAGS_FOLDER/crawl_tienphong.py', '--cfg-path', '/tmp/tmp208hpkgr']
[2023-01-27T14:41:32.664+0000] {standard_task_runner.py:83} INFO - Job 420: Subtask crawler
[2023-01-27T14:41:32.738+0000] {task_command.py:388} INFO - Running <TaskInstance: crawl_tienphong.crawler manual__2023-01-27T14:41:30.208431+00:00 [running]> on host 9be4ecca8506
[2023-01-27T14:41:32.872+0000] {taskinstance.py:1509} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=phukaioh
AIRFLOW_CTX_DAG_ID=crawl_tienphong
AIRFLOW_CTX_TASK_ID=crawler
AIRFLOW_CTX_EXECUTION_DATE=2023-01-27T14:41:30.208431+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=manual__2023-01-27T14:41:30.208431+00:00
[2023-01-27T14:41:32.873+0000] {subprocess.py:63} INFO - Tmp dir root location: 
 /tmp
[2023-01-27T14:41:32.874+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'cd /opt/project/ && ls -la && pip install scrapy && scrapy version ']
[2023-01-27T14:41:32.890+0000] {subprocess.py:86} INFO - Output:
[2023-01-27T14:41:32.895+0000] {subprocess.py:93} INFO - total 36
[2023-01-27T14:41:32.896+0000] {subprocess.py:93} INFO - drwxrwxr-x 5 default 1001 4096 Jan 27 14:40 .
[2023-01-27T14:41:32.896+0000] {subprocess.py:93} INFO - drwxr-xr-x 1 root    root 4096 Jan 27 13:53 ..
[2023-01-27T14:41:32.896+0000] {subprocess.py:93} INFO - drwxrwxr-x 4 default 1001 4096 Jan 26 03:12 crawler
[2023-01-27T14:41:32.897+0000] {subprocess.py:93} INFO - drwxrwxr-x 2 default 1001 4096 Jan 27 13:29 data
[2023-01-27T14:41:32.897+0000] {subprocess.py:93} INFO - -rw-rw-r-- 1 default 1001   69 Jan 27 13:13 run_crawl_tienphong.sh
[2023-01-27T14:41:32.897+0000] {subprocess.py:93} INFO - -rw-rw-r-- 1 default 1001  257 Jan 26 03:08 scrapy.cfg
[2023-01-27T14:41:32.897+0000] {subprocess.py:93} INFO - drwxrwxr-x 2 default 1001 4096 Jan 27 13:29 source
[2023-01-27T14:41:32.897+0000] {subprocess.py:93} INFO - -rw-rw-r-- 1 default 1001    6 Jan 27 13:16 test.sh
[2023-01-27T14:41:34.247+0000] {subprocess.py:93} INFO - Defaulting to user installation because normal site-packages is not writeable
[2023-01-27T14:41:35.554+0000] {subprocess.py:93} INFO - Collecting scrapy
[2023-01-27T14:41:38.378+0000] {subprocess.py:93} INFO -   Downloading Scrapy-2.7.1-py2.py3-none-any.whl (271 kB)
[2023-01-27T14:42:48.230+0000] {subprocess.py:93} INFO -      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━     245.8/271.5 kB 5.1 kB/s eta 0:00:06
[2023-01-27T14:42:48.237+0000] {subprocess.py:93} INFO - ERROR: Exception:
[2023-01-27T14:42:48.237+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-01-27T14:42:48.237+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_vendor/urllib3/response.py", line 437, in _error_catcher
[2023-01-27T14:42:48.237+0000] {subprocess.py:93} INFO -     yield
[2023-01-27T14:42:48.237+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_vendor/urllib3/response.py", line 560, in read
[2023-01-27T14:42:48.238+0000] {subprocess.py:93} INFO -     data = self._fp_read(amt) if not fp_closed else b""
[2023-01-27T14:42:48.238+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_vendor/urllib3/response.py", line 526, in _fp_read
[2023-01-27T14:42:48.238+0000] {subprocess.py:93} INFO -     return self._fp.read(amt) if amt is not None else self._fp.read()
[2023-01-27T14:42:48.238+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_vendor/cachecontrol/filewrapper.py", line 90, in read
[2023-01-27T14:42:48.238+0000] {subprocess.py:93} INFO -     data = self.__fp.read(amt)
[2023-01-27T14:42:48.238+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.7/http/client.py", line 465, in read
[2023-01-27T14:42:48.238+0000] {subprocess.py:93} INFO -     n = self.readinto(b)
[2023-01-27T14:42:48.239+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.7/http/client.py", line 509, in readinto
[2023-01-27T14:42:48.239+0000] {subprocess.py:93} INFO -     n = self.fp.readinto(b)
[2023-01-27T14:42:48.239+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.7/socket.py", line 589, in readinto
[2023-01-27T14:42:48.239+0000] {subprocess.py:93} INFO -     return self._sock.recv_into(b)
[2023-01-27T14:42:48.239+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.7/ssl.py", line 1071, in recv_into
[2023-01-27T14:42:48.239+0000] {subprocess.py:93} INFO -     return self.read(nbytes, buffer)
[2023-01-27T14:42:48.239+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.7/ssl.py", line 929, in read
[2023-01-27T14:42:48.239+0000] {subprocess.py:93} INFO -     return self._sslobj.read(len, buffer)
[2023-01-27T14:42:48.240+0000] {subprocess.py:93} INFO - socket.timeout: The read operation timed out
[2023-01-27T14:42:48.240+0000] {subprocess.py:93} INFO - 
[2023-01-27T14:42:48.240+0000] {subprocess.py:93} INFO - During handling of the above exception, another exception occurred:
[2023-01-27T14:42:48.240+0000] {subprocess.py:93} INFO - 
[2023-01-27T14:42:48.240+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2023-01-27T14:42:48.240+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_internal/cli/base_command.py", line 160, in exc_logging_wrapper
[2023-01-27T14:42:48.240+0000] {subprocess.py:93} INFO -     status = run_func(*args)
[2023-01-27T14:42:48.241+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_internal/cli/req_command.py", line 247, in wrapper
[2023-01-27T14:42:48.241+0000] {subprocess.py:93} INFO -     return func(self, options, args)
[2023-01-27T14:42:48.241+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_internal/commands/install.py", line 401, in run
[2023-01-27T14:42:48.241+0000] {subprocess.py:93} INFO -     reqs, check_supported_wheels=not options.target_dir
[2023-01-27T14:42:48.241+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_internal/resolution/resolvelib/resolver.py", line 93, in resolve
[2023-01-27T14:42:48.241+0000] {subprocess.py:93} INFO -     collected.requirements, max_rounds=try_to_avoid_resolution_too_deep
[2023-01-27T14:42:48.241+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_vendor/resolvelib/resolvers.py", line 481, in resolve
[2023-01-27T14:42:48.242+0000] {subprocess.py:93} INFO -     state = resolution.resolve(requirements, max_rounds=max_rounds)
[2023-01-27T14:42:48.242+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_vendor/resolvelib/resolvers.py", line 348, in resolve
[2023-01-27T14:42:48.242+0000] {subprocess.py:93} INFO -     self._add_to_criteria(self.state.criteria, r, parent=None)
[2023-01-27T14:42:48.242+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_vendor/resolvelib/resolvers.py", line 172, in _add_to_criteria
[2023-01-27T14:42:48.242+0000] {subprocess.py:93} INFO -     if not criterion.candidates:
[2023-01-27T14:42:48.242+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_vendor/resolvelib/structs.py", line 151, in __bool__
[2023-01-27T14:42:48.242+0000] {subprocess.py:93} INFO -     return bool(self._sequence)
[2023-01-27T14:42:48.243+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_internal/resolution/resolvelib/found_candidates.py", line 155, in __bool__
[2023-01-27T14:42:48.243+0000] {subprocess.py:93} INFO -     return any(self)
[2023-01-27T14:42:48.243+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_internal/resolution/resolvelib/found_candidates.py", line 143, in <genexpr>
[2023-01-27T14:42:48.243+0000] {subprocess.py:93} INFO -     return (c for c in iterator if id(c) not in self._incompatible_ids)
[2023-01-27T14:42:48.243+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_internal/resolution/resolvelib/found_candidates.py", line 47, in _iter_built
[2023-01-27T14:42:48.243+0000] {subprocess.py:93} INFO -     candidate = func()
[2023-01-27T14:42:48.244+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_internal/resolution/resolvelib/factory.py", line 211, in _make_candidate_from_link
[2023-01-27T14:42:48.244+0000] {subprocess.py:93} INFO -     version=version,
[2023-01-27T14:42:48.244+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_internal/resolution/resolvelib/candidates.py", line 303, in __init__
[2023-01-27T14:42:48.244+0000] {subprocess.py:93} INFO -     version=version,
[2023-01-27T14:42:48.244+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_internal/resolution/resolvelib/candidates.py", line 162, in __init__
[2023-01-27T14:42:48.244+0000] {subprocess.py:93} INFO -     self.dist = self._prepare()
[2023-01-27T14:42:48.244+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_internal/resolution/resolvelib/candidates.py", line 231, in _prepare
[2023-01-27T14:42:48.245+0000] {subprocess.py:93} INFO -     dist = self._prepare_distribution()
[2023-01-27T14:42:48.245+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_internal/resolution/resolvelib/candidates.py", line 308, in _prepare_distribution
[2023-01-27T14:42:48.245+0000] {subprocess.py:93} INFO -     return preparer.prepare_linked_requirement(self._ireq, parallel_builds=True)
[2023-01-27T14:42:48.245+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_internal/operations/prepare.py", line 491, in prepare_linked_requirement
[2023-01-27T14:42:48.245+0000] {subprocess.py:93} INFO -     return self._prepare_linked_requirement(req, parallel_builds)
[2023-01-27T14:42:48.245+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_internal/operations/prepare.py", line 542, in _prepare_linked_requirement
[2023-01-27T14:42:48.245+0000] {subprocess.py:93} INFO -     hashes,
[2023-01-27T14:42:48.246+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_internal/operations/prepare.py", line 170, in unpack_url
[2023-01-27T14:42:48.246+0000] {subprocess.py:93} INFO -     hashes=hashes,
[2023-01-27T14:42:48.246+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_internal/operations/prepare.py", line 107, in get_http_url
[2023-01-27T14:42:48.246+0000] {subprocess.py:93} INFO -     from_path, content_type = download(link, temp_dir.path)
[2023-01-27T14:42:48.246+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_internal/network/download.py", line 147, in __call__
[2023-01-27T14:42:48.246+0000] {subprocess.py:93} INFO -     for chunk in chunks:
[2023-01-27T14:42:48.246+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_internal/cli/progress_bars.py", line 53, in _rich_progress_bar
[2023-01-27T14:42:48.247+0000] {subprocess.py:93} INFO -     for chunk in iterable:
[2023-01-27T14:42:48.247+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_internal/network/utils.py", line 87, in response_chunks
[2023-01-27T14:42:48.247+0000] {subprocess.py:93} INFO -     decode_content=False,
[2023-01-27T14:42:48.247+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_vendor/urllib3/response.py", line 621, in stream
[2023-01-27T14:42:48.247+0000] {subprocess.py:93} INFO -     data = self.read(amt=amt, decode_content=decode_content)
[2023-01-27T14:42:48.247+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_vendor/urllib3/response.py", line 586, in read
[2023-01-27T14:42:48.247+0000] {subprocess.py:93} INFO -     raise IncompleteRead(self._fp_bytes_read, self.length_remaining)
[2023-01-27T14:42:48.247+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.7/contextlib.py", line 130, in __exit__
[2023-01-27T14:42:48.247+0000] {subprocess.py:93} INFO -     self.gen.throw(type, value, traceback)
[2023-01-27T14:42:48.248+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.7/site-packages/pip/_vendor/urllib3/response.py", line 442, in _error_catcher
[2023-01-27T14:42:48.248+0000] {subprocess.py:93} INFO -     raise ReadTimeoutError(self._pool, None, "Read timed out.")
[2023-01-27T14:42:48.248+0000] {subprocess.py:93} INFO - pip._vendor.urllib3.exceptions.ReadTimeoutError: HTTPSConnectionPool(host='files.pythonhosted.org', port=443): Read timed out.
[2023-01-27T14:42:53.095+0000] {subprocess.py:97} INFO - Command exited with return code 2
[2023-01-27T14:42:53.108+0000] {taskinstance.py:1768} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/bash.py", line 197, in execute
    f"Bash command failed. The command returned a non-zero exit code {result.exit_code}."
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 2.
[2023-01-27T14:42:53.113+0000] {taskinstance.py:1323} INFO - Marking task as UP_FOR_RETRY. dag_id=crawl_tienphong, task_id=crawler, execution_date=20230127T144130, start_date=20230127T144132, end_date=20230127T144253
[2023-01-27T14:42:53.134+0000] {standard_task_runner.py:105} ERROR - Failed to execute job 420 for task crawler (Bash command failed. The command returned a non-zero exit code 2.; 3756)
[2023-01-27T14:42:53.175+0000] {local_task_job.py:208} INFO - Task exited with return code 1
[2023-01-27T14:42:53.195+0000] {taskinstance.py:2578} INFO - 0 downstream tasks scheduled from follow-on schedule check
